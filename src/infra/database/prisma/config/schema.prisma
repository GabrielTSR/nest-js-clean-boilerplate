generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model Account {
    id String @id @default(uuid())

    email             String  @unique
    password          String
    profile_photo_url String?

    refresh_token String? @db.Text
    expires_at    Int?

    permissions Permission[] @relation("account_to_permission")
    owned_rooms Room[]
    questions   Question[]

    created_at DateTime @default(now())
    updated_at DateTime @updatedAt

    @@map("accounts")
}

model Permission {
    id String @id @default(uuid())

    name        String
    description String?

    linked_accounts Account[] @relation("account_to_permission")
    room            Room      @relation(fields: [roomId], references: [id])
    roomId          String

    @@map("permissions")
}

model Room {
    id String @id @default(uuid())

    code String
    name String

    owner   Account @relation(fields: [ownerId], references: [id])
    ownerId String

    permissions Permission[]
    questions   Question[]

    created_at DateTime  @default(now())
    updated_at DateTime  @updatedAt
    deleted_at DateTime?

    @@map("rooms")
}

model Question {
    id String @id @default(uuid())

    author   Account @relation(fields: [authorId], references: [id])
    authorId String

    room   Room   @relation(fields: [roomId], references: [id])
    roomId String

    content       String
    answer        String?
    isAnswered    Boolean
    isHighlighted Boolean
    likes         Int

    created_at DateTime  @default(now())
    updated_at DateTime  @updatedAt
    deleted_at DateTime?

    @@map("questions")
}
